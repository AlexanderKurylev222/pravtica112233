Задание 5
1. Вывести покупателей с количеством осуществленных покупок:
sql
Копировать
Редактировать
SELECT 
    Покупатели.Имя,
    Покупатели.Фамилия,
    COUNT(Покупки.Идентификатор) AS Количество_покупок
FROM 
    Покупатели
JOIN 
    Покупки ON Покупатели.Идентификатор = Покупки.Ключ_покупателя
GROUP BY 
    Покупатели.Идентификатор, Покупатели.Имя, Покупатели.Фамилия;

   
3. Общую стоимость товаров для каждого покупателя и отсортировать результат в порядке убывания:
sql
Копировать
Редактировать
SELECT 
    Покупатели.Имя,
    Покупатели.Фамилия,
    SUM(Товары.Стоимость) AS Общая_стоимость
FROM 
    Покупатели
JOIN 
    Покупки ON Покупатели.Идентификатор = Покупки.Ключ_покупателя
JOIN 
    Товары ON Покупки.Ключ_товара = Товары.Идентификатор
GROUP BY 
    Покупатели.Идентификатор, Покупатели.Имя, Покупатели.Фамилия
ORDER BY 
    Общая_стоимость DESC;

   
5. Получить покупателей, купивших только один товар:
sql
Копировать
Редактировать
SELECT 
    Покупатели.Имя,
    Покупатели.Фамилия
FROM 
    Покупатели
JOIN 
    Покупки ON Покупатели.Идентификатор = Покупки.Ключ_покупателя
GROUP BY 
    Покупатели.Идентификатор, Покупатели.Имя, Покупатели.Фамилия
HAVING 
    COUNT(Покупки.Идентификатор) = 1;
